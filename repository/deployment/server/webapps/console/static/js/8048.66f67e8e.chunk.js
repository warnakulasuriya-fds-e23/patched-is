"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[8048],{18048:(e,t,n)=>{n.r(t),n.d(t,{default:()=>de});var o=n(55007),r=n(34839),a=n(15031),i=n(86105),l=n(6833),c=n(82406),u=n(43516),s=n(44194),m=n(10479),p=n(47245),d=n(11526),f=n(96124),g=n(76271),v=n(43939);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function E(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=b(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==b(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var T=d.AsgardeoSPAClient.getInstance().httpRequest.bind(d.AsgardeoSPAClient.getInstance()).bind(d.AsgardeoSPAClient.getInstance()),S=n(30382),A=n(89141);function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var j=function(e){var t,n=e.isEmailTemplatesListLoading,r=e.selectedEmailTemplate,i=e.selectedLocale,l=e.onTemplateChanged,c=e.onSubmit,d=e.onDeleteRequested,f=e.readOnly,g=e["data-componentid"],v=(0,m.$)().t,b=(0,u.fQ)().getLink,y=(0,p.v9)((function(e){return e.config.ui.features})),h=O((0,s.useState)(0),2),E=h[0],T=h[1];return(0,s.useEffect)((function(){T((E+1)%100)}),[r]),n?s.createElement(u.pO,null):s.createElement(s.Fragment,null,s.createElement(S.l0,{id:"email-customization-content-form",uncontrolledForm:!0,onSubmit:c,"data-componentid":g},s.createElement(A.Z,null,s.createElement(A.Z.Row,null,s.createElement(A.Z.Column,{mobile:16,computer:8},s.createElement(S.gN.Input,{ariaLabel:"Email Subject Input",inputType:"default",name:"emailSubject",label:v("extensions:develop.emailTemplates.form.inputs.subject.label"),placeholder:v("extensions:develop.emailTemplates.form.inputs.subject.placeholder"),hint:v("extensions:develop.emailTemplates.form.inputs.subject.hint"),required:!0,value:null==r?void 0:r.subject,maxLength:255,minLength:1,"data-componentid":"".concat(g,"-email-subject"),listen:function(e){l({subject:e})},readOnly:f,key:E}))),s.createElement(A.Z.Row,null,s.createElement(A.Z.Column,{mobile:16,computer:8},s.createElement(u.X6,{as:"h6"},v("extensions:develop.emailTemplates.form.inputs.body.label")),s.createElement(u.v0,{type:"info",content:s.createElement(s.Fragment,null,v("extensions:develop.emailTemplates.form.inputs.body.hint"),s.createElement(u.eb,{link:b("develop.emailCustomization.form.emailBody.learnMore")},v("common:learnMore")))}))),s.createElement(A.Z.Row,null,s.createElement(A.Z.Column,{mobile:16,computer:16},s.createElement("div",{className:"code-editor-wrapper"},s.createElement(u.pq,{lint:!0,allowFullScreen:!0,smart:!0,controlledFullScreenMode:!1,language:"htmlmixed",sourceCode:null==r?void 0:r.body,lineWrapping:!0,onChange:function(e,t,n){l({body:e.getValue()})},height:"500px",theme:"light",translations:{copyCode:v("common:copyToClipboard"),exitFullScreen:v("common:exitFullScreen"),goFullScreen:v("common:goFullScreen")},"data-componentId":"".concat(g,"-email-body-editor"),readOnly:f})))),s.createElement(A.Z.Row,null,s.createElement(A.Z.Column,{mobile:16,computer:8},s.createElement(S.gN.Input,{ariaLabel:"Email Footer Input",inputType:"default",name:"emailFooter",label:v("extensions:develop.emailTemplates.form.inputs.footer.label"),placeholder:v("extensions:develop.emailTemplates.form.inputs.footer.placeholder"),hint:v("extensions:develop.emailTemplates.form.inputs.footer.hint"),required:!1,value:null==r?void 0:r.footer,maxLength:255,minLength:1,"data-componentid":"".concat(g,"-email-footer"),listen:function(e){l({footer:e})},readOnly:f,key:E}))))),s.createElement(o.di,{when:null==y||null===(t=y.emailTemplates)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.delete},s.createElement(u.cN,{"data-componentid":"".concat(g,"-revert-email-provider-config"),actionTitle:v("extensions:develop.emailTemplates.dangerZone.action"),header:v("extensions:develop.emailTemplates.dangerZone.heading"),subheader:v("extensions:develop.emailTemplates.dangerZone.message"),isButtonDisabled:i===a.b.DEFAULT_FALLBACK_LANGUAGE,buttonDisableHint:v("extensions:develop.emailTemplates.dangerZone.actionDisabledHint"),onActionClick:d})))};j.defaultProps={"data-componentid":"email-customization-form"};var _=n(28077),L=n(80777),P=n(17473),F=n(16590),C=n(64732),x=n(60826);function k(e){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k(e)}function R(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,D(o.key),o)}}function D(e){var t=function(e,t){if("object"!=k(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=k(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==k(t)?t:t+""}var U,I,M,z=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"getTemplateBody",value:function(e,t,n,o,r){var a,i,l,c=o;if(!(null==t||null===(a=t.theme[null==t||null===(i=t.theme)||void 0===i?void 0:i.activeTheme])||void 0===a||null===(a=a.images)||void 0===a||null===(a=a.logo)||void 0===a||!a.imgURL)||(c=c.replace(/alt="{{organization.logo.altText}}"/g,"").replace(/src="{{organization.logo.img}}"/g,"")),!t)return c.replace(/{{organization.color.background}}/g,this.brandingFallBackValues.background_color).replace(/{{organization.color.primary}}/g,this.brandingFallBackValues.primary_color).replace(/{{organization.theme.background.color}}/g,this.brandingFallBackValues.light_background_color).replace(/{{organization.theme.border.color}}/g,this.brandingFallBackValues.light_border_color).replace(/{{organization.font}}/g,this.brandingFallBackValues.font_style).replace(/{{organization.font.color}}/g,this.brandingFallBackValues.font_color).replace(/{{organization.button.font.color}}/g,this.brandingFallBackValues.button_font_color).replace(/{{organization-name}}/g,e).replace(/{{organization.logo.img}}/g,this.brandingFallBackValues.light_logo_url);var u=P.t.migrateThemePreference(t,{theme:r}),s=u.organizationDetails,m=s.copyrightText,p=s.supportEmail,d=s.displayName,f=u.theme,g=f[f.activeTheme],v=f.activeTheme===x.gf.DARK?this.brandingFallBackValues.dark_logo_url:this.brandingFallBackValues.light_logo_url;return c=c.replace(/{{organization.color.background}}/g,g.colors.background.body.main).replace(/{{organization.color.primary}}/g,g.colors.primary.main).replace(/{{organization.theme.background.color}}/g,g.colors.background.surface.main?g.colors.background.surface.main:f.activeTheme===x.gf.DARK?"#111111":"#FFFFFF").replace(/{{organization.theme.border.color}}/g,g.colors.outlined.default?g.colors.outlined.default:f.activeTheme===x.gf.DARK?"#333333":"transparent").replace(/{{organization.font}}/g,g.typography.font.fontFamily).replace(/{{organization.font.color}}/g,g.colors.text.primary).replace(/{{organization.button.font.color}}/g,g.buttons.primary.base.font.color).replace(/{{organization-name}}/g,d||e).replace(/{{organization.logo.img}}/g,g.images.logo.imgURL||v).replace(/{{organization.logo.altText}}/g,g.images.logo.altText).replace(/{{organization.copyright.text}}/g,null!==(l=n&&(0,C.Z)(n.copyright))&&void 0!==l?l:m).replace(/{{organization.support.mail}}/g,p)}}],(t=null)&&R(e.prototype,t),n&&R(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function N(e){return N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N(e)}function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){Z(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Z(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=N(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=N(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==N(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}U=z,M={background_color:"#F8F9FA",button_font_color:"#FFFFFF",copyright_text:"&#169; YYYY WSO2 LLC.",dark_background_color:"#111111",dark_border_color:"#333333",dark_logo_url:"",font_color:"#231F20",font_style:"Montserrat",light_background_color:"#FFFFFF",light_border_color:"transparent",light_logo_url:"",primary_color:"#FF7300"},(I=D(I="brandingFallBackValues"))in U?Object.defineProperty(U,I,{value:M,enumerable:!0,configurable:!0,writable:!0}):U[I]=M;var Q=function(e){var t=e.emailTemplate,n=e["data-componentid"],o=(0,L.Z)(),r=o.preference,a=o.customText,i=q((0,s.useState)(!1),2)[1],l=q((0,s.useState)(_.H.DEFAULT_PREFERENCE.theme),2),c=l[0],m=l[1],d=(0,p.v9)((function(e){var t;return null==e||null===(t=e.organization)||void 0===t||null===(t=t.organization)||void 0===t?void 0:t.name})),f=(0,p.v9)((function(e){var t;return null===(t=e.config.ui.theme)||void 0===t?void 0:t.name})),g=(0,s.useMemo)((function(){return null!=t&&t.body?z.getTemplateBody(d,null==r?void 0:r.preference,a,null==t?void 0:t.body,c):""}),[null==t?void 0:t.body,d,null==r?void 0:r.preference,c]);return(0,s.useEffect)((function(){f&&P.t.getPredefinedThemePreferences(f).then((function(e){m(B(B({},c),e))}))}),[f]),s.createElement("div",{className:"email-template-preview","data-componentid":n},s.createElement(u.hv,{isReady:i,"data-componentid":"".concat(n,"-iframe"),className:"email-template-preview-iframe"},s.createElement("div",{dangerouslySetInnerHTML:{__html:F.Encode.forHtml(g)},"data-componentid":"".concat(n,"-iframe-body-div")})))};Q.defaultProps={"data-componentid":"email-customization-preview"};var $=n(19980),K=function(e){var t=e["data-componentid"],n=e.isSaveButtonLoading,o=e.onSaveButtonClick,r=(0,m.$)().t;return s.createElement($.Z,{className:"email-customization-footer",attached:"bottom",padded:!0,"data-componentid":t},s.createElement(u.KM,{size:"small",loading:n,onClick:function(e,t){o(e,t)},ariaLabel:"Email Templates form save button","data-componentid":"".concat(t,"-save-button")},r("common:save")))};K.defaultProps={"data-componentid":"email-customization-footer"};const Y=K;function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return W(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var X=function(e){var t=e.selectedEmailTemplateId,n=e.selectedEmailTemplateDescription,o=e.selectedLocale,r=e.emailTemplatesList,a=e.onTemplateSelected,i=e.onLocaleChanged,l=e["data-componentid"],c=(0,m.$)().t,u=H((0,s.useState)(void 0),2),d=u[0],f=u[1],g=(0,p.v9)((function(e){return e.global.supportedI18nLanguages})),v=(0,s.useMemo)((function(){return null==r?void 0:r.map((function(e){return{text:e.displayName,value:e.id}}))}),[r]);return(0,s.useEffect)((function(){if(g){var e=[];Object.keys(g).map((function(t){e.push({key:g[t].code,text:s.createElement("div",null,s.createElement("i",{className:g[t].flag+" flag"}),g[t].name,", ",g[t].code),value:g[t].code})})),f(e)}}),[g]),s.createElement($.Z,{className:"mb-4 p-4","data-componentid":l,padded:"very"},s.createElement(S.l0,{id:"email-customization-header-form",uncontrolledForm:!0,onSubmit:function(){}},s.createElement(A.Z,null,s.createElement(A.Z.Column,{mobile:16,computer:8},s.createElement(S.gN.Dropdown,{ariaLabel:"Email Template Dropdown",name:"selectedEmailTemplate",label:c("extensions:develop.emailTemplates.form.inputs.template.label"),options:v,required:!0,"data-componentid":"".concat(l,"-email-template-list"),hint:null!=n?n:null,placeholder:c("extensions:develop.emailTemplates.form.inputs.template.placeholder"),value:t,listen:a})),s.createElement(A.Z.Column,{mobile:16,computer:8},s.createElement(S.gN.Dropdown,{ariaLabel:"Email Template Locale Dropdown",name:"selectedEmailTemplateLocale",label:c("extensions:develop.emailTemplates.form.inputs.locale.label"),options:d,required:!0,"data-componentid":"".concat(l,"-email-template-locale"),placeholder:c("extensions:develop.emailTemplates.form.inputs.locale.placeholder"),defaultValue:o,value:o,listen:i})))))};X.defaultProps={"data-componentid":"email-customization-header"};const J=X;function ee(e){return ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ee(e)}function te(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,re(o.key),o)}}function ne(e,t,n){return t&&te(e.prototype,t),n&&te(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function oe(e,t,n){return(t=re(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function re(e){var t=function(e,t){if("object"!=ee(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=ee(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ee(t)?t:t+""}var ae=ne((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function le(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?le(Object(n),!0).forEach((function(t){ue(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ue(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=ie(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=ie(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ie(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return me(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?me(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}oe(ae,"DEFAULT_CONTENT_TYPE","text/html; charset=UTF-8"),oe(ae,"FEATURE_DICTIONARY",(new Map).set("EMAIL_TEMPLATES_CREATE","emailTemplates.create").set("EMAIL_TEMPLATES_UPDATE","emailTemplates.update").set("EMAIL_TEMPLATES_DELETE","emailTemplates.delete").set("EMAIL_TEMPLATES_READ","emailTemplates.read"));var pe=function(e){var t,n,d,b,y,E,S,A=e["data-componentid"],O=se((0,s.useState)([]),2),w=O[0],_=O[1],L=se((0,s.useState)(),2),P=L[0],F=L[1],C=se((0,s.useState)(),2),x=C[0],k=C[1],R=se((0,s.useState)(a.b.DEFAULT_FALLBACK_LANGUAGE),2),D=R[0],U=R[1],I=se((0,s.useState)(),2),M=I[0],z=I[1],N=se((0,s.useState)(),2),V=N[0],B=N[1],Z=se((0,s.useState)(!1),2),q=Z[0],G=Z[1],$=se((0,s.useState)(!1),2),K=$[0],H=$[1],W=se((0,s.useState)(!1),2),X=W[0],ee=W[1],te=(0,p.v9)((function(e){return e.config.deployment.extensions.emailTemplates})),ne=(0,p.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.enableCustomEmailTemplates})),oe=(0,p.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.emailTemplates})),re=(0,p.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),ie=(0,p.v9)((function(e){return e.config.ui.features})),le=(0,p.I0)(),ue=(0,m.$)().t,me=(0,u.fQ)().getLink,pe=(0,o.EV)(null==oe||null===(t=oe.scopes)||void 0===t?void 0:t.update),de=(0,o.EV)(null==oe||null===(n=oe.scopes)||void 0===n?void 0:n.create),fe=(0,s.useMemo)((function(){return!(0,i.cr)(oe,ae.FEATURE_DICTIONARY.get("EMAIL_TEMPLATES_UPDATE"))||!pe}),[oe,re]),ge=(0,s.useMemo)((function(){return(0,i.cr)(oe,ae.FEATURE_DICTIONARY.get("EMAIL_TEMPLATES_CREATE"))&&de}),[oe,re]),ve=(b={headers:{Accept:"application/json","Content-Type":"application/json"},method:l.f2.GET,url:"".concat(g.h.getState().config.endpoints.emailManagement,"/template-types")},y=(0,f.Z)(b),E=y.data,S=y.error,{data:E,error:S,isLoading:!S&&!E,isValidating:y.isValidating,mutate:y.mutate}),be=ve.data,ye=ve.isLoading,he=ve.error,Ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.b.DEFAULT_FALLBACK_LANGUAGE,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=t.replace("-","_"),r={headers:{Accept:"application/json","Content-Type":"application/json"},method:l.f2.GET,url:g.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/templates/").concat(o)},i=(0,f.Z)(n?r:null,{onErrorRetry:function(e){e.response.status}}),c=i.data,u=i.error;return{data:c,error:u,isLoading:!u&&!c,isValidating:i.isValidating,mutate:i.mutate}}(P,D,!!P),Te=Ee.data,Se=Ee.isLoading,Ae=Ee.error,Oe=Ee.mutate;(0,s.useEffect)((function(){var e,t,n=be?(ne?be:be.filter((function(e){return null==te?void 0:te.find((function(t){return t.id===e.id}))}))).map((function(e){var t=null==te?void 0:te.find((function(t){return t.id===e.id}));return ce(ce({},e),{},{description:(null==t?void 0:t.description)||"".concat(e.displayName," Template"),displayName:(null==t?void 0:t.displayName)||e.displayName})})):[];(_(n),P)||(F(null==n||null===(e=n[0])||void 0===e?void 0:e.id),k(null==n||null===(t=n[0])||void 0===t?void 0:t.description))}),[be]),(0,s.useEffect)((function(){z(ce({},Te)),ee(!1),Te&&Object.keys(Te).length>0&&B(ce({},Te))}),[Te]),(0,s.useEffect)((function(){var e,t;he&&(he.response.data.description?le((0,c.V_)({description:null===(e=he.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.description,level:l.QU.ERROR,message:null!==(t=he.response.data.message)&&void 0!==t?t:ue("extensions:develop.emailTemplates.notifications.getEmailTemplateList.error.message")})):le((0,c.V_)({description:ue("extensions:develop.emailTemplates.notifications.getEmailTemplateList.error.description"),level:l.QU.ERROR,message:ue("extensions:develop.emailTemplates.notifications.getEmailTemplateList.error.message")})))}),[he]),(0,s.useEffect)((function(){if(Ae&&P){if(404===Ae.response.status)return ee(!0),ge?void G(!0):(B(void 0),void H(!0));var e,t;if(Ae.response.data.description)le((0,c.V_)({description:null===(e=Ae.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.description,level:l.QU.ERROR,message:null!==(t=Ae.response.data.message)&&void 0!==t?t:ue("extensions:develop.emailTemplates.notifications.getEmailTemplate.error.message")}));else le((0,c.V_)({description:ue("extensions:develop.emailTemplates.notifications.getEmailTemplate.error.description"),level:l.QU.ERROR,message:ue("extensions:develop.emailTemplates.notifications.getEmailTemplate.error.message")}))}}),[Ae]),(0,s.useEffect)((function(){var e=window.location.hash;if(e.startsWith("#templateId=")){var t,n=e.split("=")[1];F(n),k(null==w||null===(t=w.find((function(e){return e.id===n})))||void 0===t?void 0:t.description)}}),[window.location.hash]);var we,je=function(){var e=ce(ce({},M),{},{id:D.replace("-","_")});null!=e&&e.contentType||(e.contentType=ae.DEFAULT_CONTENT_TYPE),X?function(e,t){var n={data:h({},t),headers:{Accept:"application/json","Content-Type":"application/json"},method:l.f2.POST,url:g.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e)};return T(n).then((function(e){if(200!==e.status&&201!==e.status)throw new v.u("Error occurred while creating the email template.",null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var t;throw new v.u("Error occurred while creating the email template.",e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))}(P,e).then((function(e){le((0,c.V_)({description:ue("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.description"),level:l.QU.SUCCESS,message:ue("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.message")}))})).catch((function(e){var t;le((0,c.V_)({description:ue("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.description"),level:l.QU.ERROR,message:null!==(t=e.message)&&void 0!==t?t:ue("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.message")}))})).finally((function(){return Oe()})):function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:a.b.DEFAULT_FALLBACK_LANGUAGE).replace("-","_"),o={data:h({},t),headers:{Accept:"application/json","Content-Type":"application/json"},method:l.f2.PUT,url:g.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/templates/").concat(n)};return T(o).then((function(e){if(200!==e.status&&201!==e.status)throw new v.u("Error occurred while updating the email template.",null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var t;throw new v.u("Error occurred while updating the email template.",e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))}(P,e,D).then((function(e){le((0,c.V_)({description:ue("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.description"),level:l.QU.SUCCESS,message:ue("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.message")}))})).catch((function(e){var t;le((0,c.V_)({description:ue("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.description"),level:l.QU.ERROR,message:null!==(t=e.message)&&void 0!==t?t:ue("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.message")}))})).finally((function(){return Oe()})),ee(!1)},_e=function(){(function(e,t){var n=t.replace("-","_"),o={headers:{Accept:"application/json","Content-Type":"application/json"},method:l.f2.DELETE,url:g.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/templates/").concat(n)};return T(o).then((function(e){if(204!==e.status)throw new v.u("Error occurred while deleting the email template.",null,e.status,e.request,e,e.config);return e})).catch((function(e){var t;throw new v.u("Error occurred while deleting the email template.",e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))})(P,D).then((function(e){le((0,c.V_)({description:ue("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.success.description"),level:l.QU.SUCCESS,message:ue("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.success.message")}))})).catch((function(e){var t;le((0,c.V_)({description:ue("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.error.description"),level:l.QU.ERROR,message:null!==(t=e.message)&&void 0!==t?t:ue("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.error.message")}))})).finally((function(){U(a.b.DEFAULT_FALLBACK_LANGUAGE)}))};return s.createElement(r.Z,null,s.createElement(u.Xg,{title:ue("extensions:develop.emailTemplates.page.header"),pageTitle:"Email Templates",description:s.createElement(s.Fragment,null,ue("extensions:develop.emailTemplates.page.description"),s.createElement(u.eb,{link:me("develop.emailCustomization.learnMore")},ue("common:learnMore"))),titleTextAlign:"left",bottomMargin:!1,"data-componentid":A},s.createElement(J,{selectedEmailTemplateId:P,selectedEmailTemplateDescription:x,selectedLocale:D,emailTemplatesList:w,onTemplateSelected:function(e){var t;ee(!1),B(void 0),U(a.b.DEFAULT_FALLBACK_LANGUAGE),F(e),k(null==w||null===(t=w.find((function(t){return t.id===e})))||void 0===t?void 0:t.description)},onLocaleChanged:function(e){B(ce({},M)),ee(!1),U(e)}}),s.createElement(u.M$,{attached:"top",secondary:!1,pointing:!1,panes:(we=[],we.push({menuItem:ue("extensions:develop.emailTemplates.tabs.preview.label"),render:function(){return s.createElement(u.M$.Pane,{className:"email-template-resource-tab-pane",attached:"bottom","data-componentid":"email-customization-template-preview"},s.createElement(Q,{emailTemplate:M||V}))}}),we.push({menuItem:ue("extensions:develop.emailTemplates.tabs.content.label"),render:function(){return s.createElement(u.M$.Pane,{className:"email-template-resource-tab-pane",attached:"bottom","data-componentid":"email-customization-template-content"},s.createElement(j,{isEmailTemplatesListLoading:ye||Se,selectedEmailTemplate:V,selectedLocale:D,onTemplateChanged:function(e){return function(e){z(ce(ce({},M),e))}(e)},onSubmit:je,onDeleteRequested:_e,readOnly:fe||X&&!ge}))}}),we),onTabChange:function(){B(M)},"data-componentid":"".concat(A,"-forms")}),s.createElement(o.di,{when:null==ie||null===(d=ie.emailTemplates)||void 0===d||null===(d=d.scopes)||void 0===d?void 0:d.update},(!X||ge)&&s.createElement(Y,{isSaveButtonLoading:ye||Se,onSaveButtonClick:je})),s.createElement(u.cV,{type:"info",open:q,primaryAction:ue("common:confirm"),secondaryAction:ue("common:cancel"),onSecondaryActionClick:function(){return z(void 0),B(void 0),void G(!1)},onPrimaryActionClick:function(){return z(V),void G(!1)},"data-componentid":"".concat(A,"-replicate-previous-template-confirmation-modal"),closeOnDimmerClick:!1},s.createElement(u.cV.Header,{"data-componentid":"".concat(A,"-replicate-previous-template-confirmation-modal-header")},ue("extensions:develop.emailTemplates.modal.replicateContent.header")),s.createElement(u.cV.Message,{attached:!0,info:!0,"data-componentid":"".concat(A,"-replicate-previous-template-confirmation-modal-message")},ue("extensions:develop.emailTemplates.modal.replicateContent.message"))),s.createElement(u.cV,{type:"info",open:K,primaryAction:ue("common:okay"),onPrimaryActionClick:function(){H(!1)},"data-componentid":"".concat(A,"-update-template-from-root-org-modal"),closeOnDimmerClick:!0},s.createElement(u.cV.Header,{"data-componentid":"".concat(A,"-update-template-from-root-org-modal-header")},ue("extensions:develop.emailTemplates.modal.updateFromRootOrg.header")),s.createElement(u.cV.Message,{attached:!0,info:!0,"data-componentid":"".concat(A,"-update-template-from-root-org-modal-message")},ue("extensions:develop.emailTemplates.modal.updateFromRootOrg.message")),s.createElement(u.cV.Content,{"data-testid":"".concat(A,"-update-template-from-root-org-modal-content")},ue("extensions:develop.emailTemplates.modal.updateFromRootOrg.content")))))};pe.defaultProps={"data-componentid":"email-customization-page"};const de=pe}}]);