"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[3961],{63961:(e,t,n)=>{n.r(t),n.d(t,{ApplicationsSettingsForm:()=>E,default:()=>R});var a=n(60486),i=n(40838),o=n(6833),s=n(82406),r=n(30382),l=n(43516),c=n(44194),p=n(10479),d=n(47245),u=n(6567),f=n(11526),g=n(76271),m=f.AsgardeoSPAClient.getInstance().httpRequest.bind(f.AsgardeoSPAClient.getInstance()),h=n(96124);function S(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,o,s,r=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=o.call(n)).done)&&(r.push(a.value),r.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return v(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var b="applications-settings",E=function(e){var t=e.mandateSSA,n=e.authenticationRequired,f=e.ssaJwks,v=e.dcrEndpoint,E=e.enableFapiEnforcement,R=e["data-componentid"],k=(0,d.I0)(),A=(0,p.$)().t,C=(0,l.fQ)().getLink,y=S((0,c.useState)(n),2),w=y[0],J=void 0===w||w,L=y[1],I=S((0,c.useState)(t),2),P=I[0],q=void 0===P?!J:P,x=I[1],F=S((0,c.useState)(E),2),O=F[0],_=F[1],T=S((0,c.useState)(f),2),j=T[0],V=T[1],M=S((0,c.useState)(v),2),U=M[0],D=M[1],N=S((0,c.useState)(!1),2),Q=N[0],B=N[1],$=S((0,c.useState)(void 0),2),H=$[0],W=$[1],z=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={headers:{Accept:"application/json","Content-Type":"application/json"},method:o.f2.GET,url:"".concat(g.h.getState().config.endpoints.dcrConfiguration)},n=(0,h.Z)(e?t:null),a=n.data,i=n.error;return{data:a,error:i,isLoading:!i&&!a,isValidating:n.isValidating,mutate:n.mutate}}(),G=z.data,K=z.error,X=z.isLoading;(0,c.useEffect)((function(){W(X)}),[X]),(0,c.useEffect)((function(){G&&(x(null==G?void 0:G.mandateSSA),L(null==G?void 0:G.authenticationRequired),_(null==G?void 0:G.enableFapiEnforcement),V(null==G?void 0:G.ssaJwks))}),[G]),(0,c.useEffect)((function(){var e;K&&(null!==(e=K.response)&&void 0!==e&&null!==(e=e.data)&&void 0!==e&&e.description?k((0,s.V_)({description:K.response.data.description,level:o.QU.ERROR,message:A("console:develop.pages.applicationsSettings.notifications.genericError.message")})):k((0,s.V_)((0,s.V_)({description:A("console:develop.pages.applicationsSettings.notifications.genericError.description"),level:o.QU.ERROR,message:A("console:develop.pages.applicationsSettings.notifications.genericError.message")}))))}),[K]),(0,c.useEffect)((function(){void 0===v&&(0,u.qt)().then((function(e){D(e.dynamicClientRegistrationEndpoint)})).catch((function(){k((0,s.V_)({description:A("applications:notifications.fetchOIDCIDPConfigs.genericError.description"),level:o.QU.ERROR,message:A("applications:notifications.fetchOIDCIDPConfigs.genericError.message")}))}))}));var Z=function(e){return A("console:develop.pages.applicationsSettings.notifications.error.description",{description:e.response.data.description})},Y=function(e){B(!0);var t=[{operation:"REPLACE",path:"/authenticationRequired",value:e.authenticationRequired},{operation:"REPLACE",path:"/enableFapiEnforcement",value:e.enableFapiEnforcement},{operation:"REPLACE",path:"/mandateSSA",value:e.mandateSSA}];null!=e.ssaJwks&&t.push({operation:"REPLACE",path:"/ssaJwks",value:e.ssaJwks}),function(e){var t={data:e,headers:{Accept:"application/json","Content-Type":"application/json"},method:o.f2.PATCH,url:g.h.getState().config.endpoints.dcrConfiguration};return m(t).then((function(e){return 200!==e.status?Promise.reject(new Error("Failed to update DCR Configuration.")):Promise.resolve(e.data)})).catch((function(e){return Promise.reject(e)}))}(t).then((function(){k((0,s.V_)({description:A("console:develop.pages.applicationsSettings.notifications.success.description"),level:o.QU.SUCCESS,message:A("console:develop.pages.applicationsSettings.notifications.success.message")}))})).catch((function(e){!function(e){var t;null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(t=t.data)&&void 0!==t&&t.detail?k((0,s.V_)({description:Z(e),level:o.QU.ERROR,message:A("console:develop.pages.applicationsSettings.notifications.error.message")})):k((0,s.V_)({description:A("console:develop.pages.applicationsSettings.notifications.genericError.description"),level:o.QU.ERROR,message:A("console:develop.pages.applicationsSettings.notifications.genericError.message")}))}(e)})).finally((function(){B(!1)}))};return H?c.createElement(l.pJ,{padded:"very"},c.createElement(l.pO,{inline:"centered",active:!0})):c.createElement(l.Xg,{title:A("console:develop.pages.applicationsSettings.title"),description:c.createElement(c.Fragment,null,A("console:develop.pages.applicationsSettings.subTitle"),c.createElement(l.eb,{link:C("develop.applications.applicationsSettings.dcr.learnMore")},A("console:develop.pages.applicationsSettings.learnMore"))),backButton:{"data-componentid":"".concat(R,"-page-back-button"),onClick:function(){i.m.push(a.$.getPaths().get("APPLICATIONS"))},text:A("console:develop.pages.applicationsSettings.backButton")},bottomMargin:!1,contentTopMargin:!0,pageHeaderMaxWidth:!0,"data-componentid":"".concat(R,"-page-layout")},c.createElement(l.pJ,{padded:"very"},c.createElement(r.l0,{id:b,uncontrolledForm:!1,onSubmit:function(e){Y(e)},initialValues:{authenticationRequired:J,dcrEndpoint:U,enableFapiEnforcement:O,mandateSSA:q,ssaJwks:j},validate:function(e){var t={ssaJwks:void 0};return q&&!e.ssaJwks&&(t.ssaJwks=A("applications:forms.applicationsSettings.fields.ssaJwks.validations.empty")),t},"data-componentid":"".concat(R,"-form")},c.createElement(r.gN.Input,{ariaLabel:"DCR Endpoint",inputType:"text",name:"dcrEndpoint",label:A("applications:forms.applicationsSettings.fields.dcrEndpoint.label"),hint:A("applications:forms.applicationsSettings.fields.dcrEndpoint.hint"),required:!1,readOnly:!0,maxLength:150,minLength:10,width:16,listen:null,"data-componentid":"".concat(R,"-dcr-endpoint-url")},c.createElement(l.OR,{value:U})),c.createElement(r.gN.Checkbox,{ariaLabel:"Require Authentication",name:"authenticationRequired",label:A("applications:forms.applicationsSettings.fields.authenticationRequired.label"),hint:c.createElement(c.Fragment,null,A("applications:forms.applicationsSettings.fields.authenticationRequired.hint"),c.createElement(l.eb,{link:C("develop.applications.applicationsSettings.dcr.authenticationRequired.learnMore")},A("console:develop.pages.applicationsSettings.learnMore"))),tabIndex:3,width:16,listen:function(e){L(e),e||x(!0)},"data-componentid":"".concat(R,"-authenticationRequired-checkbox")}),c.createElement(r.gN.Checkbox,{ariaLabel:"Mandate SSA",name:"mandateSSA",label:A("applications:forms.applicationsSettings.fields.mandateSSA.label"),hint:A("applications:forms.applicationsSettings.fields.mandateSSA.hint"),tabIndex:3,width:16,readOnly:!J,listen:function(e){return x(e)},"data-componentid":"".concat(R,"-mandateSSA-checkbox")}),c.createElement(r.gN.Input,{ariaLabel:"JWKS Endpoint",inputType:"url",name:"ssaJwks",label:A("applications:forms.applicationsSettings.fields.ssaJwks.label"),placeholder:A("applications:forms.applicationsSettings.fields.ssaJwks.placeholder"),hint:A("applications:forms.applicationsSettings.fields.ssaJwks.hint"),required:q||!J,maxLength:150,minLength:10,width:16,"data-componentid":"".concat(R,"-ssaJwks-url")}),c.createElement(r.gN.Checkbox,{ariaLabel:"Enforce Fapi",name:"enableFapiEnforcement",label:A("applications:forms.applicationsSettings.fields.enforceFapi.label"),hint:A("applications:forms.applicationsSettings.fields.enforceFapi.hint"),tabIndex:3,width:16,listen:function(e){return _(e)},"data-componentid":"".concat(R,"-enableFapiEnforcement-checkbox")}),c.createElement(r.gN.Button,{form:b,size:"small",buttonType:"primary_btn",ariaLabel:"DCR Configuration update button",name:"update-button",disabled:Q,loading:Q,label:A("common:update"),"data-componentid":"".concat(R,"-submit-button")}))))};E.defaultProps={"data-componentid":"applications-settings-page"};const R=E}}]);