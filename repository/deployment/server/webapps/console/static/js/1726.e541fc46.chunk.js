"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[1726,4755],{41726:(e,t,n)=>{n.r(t),n.d(t,{AttributeMappings:()=>C,default:()=>T});var i=n(6894),a=n(1989),r=n(60486),l=n(40838),c=n(51021),o=n(6833),u=n(82406),s=n(43516),d=n(76004),m=n.n(d),f=n(44194),p=n(10479),E=n(47245),g=n(93682),h=n(14755),v=(n(53103),n(12252)),b=n(99116);function A(e){return function(e){if(Array.isArray(e))return S(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||y(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r,l,c=[],o=!0,u=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(i=r.call(n)).done)&&(c.push(i.value),c.length!==t);o=!0);}catch(e){u=!0,a=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}(e,t)||y(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var C=function(e){var t,n,d=e["data-testid"],y=e.match.params,S=y.type,C=y.customAttributeMappingID,T=(0,E.I0)(),M=(0,E.v9)((function(e){return e.config.ui.listAllAttributeDialects})),R=(0,E.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.userSchemaURI})),D=(0,p.$)().t,U=(0,s.fQ)().getLink,Q=I((0,f.useState)(!0),2),_=Q[0],L=Q[1],B=I((0,f.useState)(null),2),x=B[0],O=B[1],w=I((0,f.useState)([]),2),Z=w[0],k=w[1],P=I((0,f.useState)(!0),2),H=P[0],j=P[1];(0,f.useEffect)((function(){$()}),[]),(0,f.useEffect)((function(){x&&x.length>0&&H&&(N(x.map((function(e){return e.id}))),j(!1))}),[x,H]);var N=function(e,t,n,a,r){var l=[];e.forEach((function(e){l.push((0,i.gR)(e,{filter:r,limit:t,offset:n,sort:a}))})),m().all(l).then((function(e){var t=[];e.forEach((function(e){var n=c.rk.attributeMappings.getExternalAttributes(S,e);t.push.apply(t,A(n.map((function(e){return e.mappedLocalClaimURI}))))})),k(t)})).catch((function(e){var t,n;T((0,u.V_)({description:(null===(t=e[0])||void 0===t||null===(t=t.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.description)||D("claims:dialects.notifications.fetchExternalClaims.genericError.description",{type:(0,b.i)(S)}),level:o.QU.ERROR,message:(null===(n=e[0])||void 0===n||null===(n=n.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)||D("claims:dialects.notifications.fetchExternalClaims.genericError.message")}))})).finally((function(){return L(!1)}))},X=function(){var e;switch(S){case v.Q.OIDC:return D("claims:attributeMappings.oidc.heading");case v.Q.SCIM:return D("claims:attributeMappings.scim.heading");case v.Q.AXSCHEMA:return D("claims:attributeMappings.axschema.heading");case v.Q.EIDAS:return D("claims:attributeMappings.eidas.heading");case v.Q.OTHERS:return x&&(null===(e=x[0])||void 0===e?void 0:e.dialectURI);default:return D("claims:attributeMappings.custom.heading")}},$=function(e,t,n,a){L(!0),(0,i.jp)({filter:a,limit:e,offset:t,sort:n}).then((function(e){var t=e.filter((function(e){return M?"local"!==e.id&&e.id!==v.Q.ATTRIBUTE_DIALECT_IDS.get("XML_SOAP")&&e.id!=v.Q.ATTRIBUTE_DIALECT_IDS.get("OPENID_NET"):e.id!=v.Q.ATTRIBUTE_DIALECT_IDS.get("LOCAL")&&e.id!=v.Q.ATTRIBUTE_DIALECT_IDS.get("AXSCHEMA")&&e.id!=v.Q.ATTRIBUTE_DIALECT_IDS.get("EIDAS_LEGAL")&&e.id!=v.Q.ATTRIBUTE_DIALECT_IDS.get("EIDAS_NATURAL")&&e.id!=v.Q.ATTRIBUTE_DIALECT_IDS.get("OPENID_NET")&&e.id!=v.Q.ATTRIBUTE_DIALECT_IDS.get("XML_SOAP")&&(c.rk.attributeMappings.showSCIMCore1||"urn:scim:schemas:core:1.0"!==e.dialectURI)})),n=[];if(t.forEach((function(e){v.Q.OIDC_MAPPING.includes(e.dialectURI)?S===v.Q.OIDC&&n.push(e):Object.values(v.Q.SCIM_TABS).map((function(e){return e.uri})).includes(e.dialectURI)?S===v.Q.SCIM&&n.push(e):v.Q.AXSCHEMA_MAPPING===e.dialectURI?S===v.Q.AXSCHEMA&&n.push(e):Object.values(v.Q.EIDAS_TABS).map((function(e){return e.uri})).includes(e.dialectURI)?S===v.Q.EIDAS&&n.push(e):S===v.Q.OTHERS&&C===e.id&&n.push(e)})),S===v.Q.SCIM&&c.rk.showCustomDialectInSCIM){var i=null==t?void 0:t.find((function(e){return e.dialectURI===R}));i&&n.push(i)}O(n)})).catch((function(e){var t,n;T((0,u.V_)({description:(null==e||null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.description)||D("claims:dialects.notifications.fetchDialects.genericError.description"),level:o.QU.ERROR,message:(null==e||null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)||D("claims:dialects.notifications.fetchDialects.genericError.message")}))})).finally((function(){L(!1)}))};return f.createElement(s.Xg,{isLoading:_,title:X(),pageTitle:X(),description:function(){switch(S){case v.Q.OIDC:return f.createElement(f.Fragment,null,D("claims:attributeMappings.oidc.description"),f.createElement(s.eb,{link:U("manage.attributes.oidcAttributes.learnMore")},D("common:learnMore")));case v.Q.SCIM:return f.createElement(f.Fragment,null,D("claims:attributeMappings.scim.description"),f.createElement(s.eb,{link:U("manage.attributes.scimAttributes.learnMore")},D("common:learnMore")));case v.Q.AXSCHEMA:return D("claims:attributeMappings.axschema.description");case v.Q.EIDAS:return D("claims:attributeMappings.eidas.description");default:return D("claims:attributeMappings.custom.description")}}(),"data-testid":"".concat(d,"-page-layout"),image:function(){var e;switch(S){case v.Q.OIDC:return f.createElement(s.dn,{verticalAlign:"middle",rounded:!0,icon:(0,a.r2)().oidc,spaced:"right",size:"tiny",floated:"left",transparent:!0});case v.Q.SCIM:return f.createElement(s.dn,{verticalAlign:"middle",rounded:!0,icon:(0,a.r2)().scim,spaced:"right",size:"tiny",floated:"left"});case v.Q.AXSCHEMA:return f.createElement(s.dn,{verticalAlign:"middle",rounded:!0,icon:(0,a.r2)().axschema,spaced:"right",size:"tiny",floated:"left"});case v.Q.EIDAS:return f.createElement(s.dn,{verticalAlign:"middle",rounded:!0,icon:(0,a.r2)().eidas,spaced:"right",size:"tiny",floated:"left"});case v.Q.OTHERS:return f.createElement(g.Z,{floated:"left",verticalAlign:"middle",rounded:!0,centered:!0,size:"tiny"},f.createElement(s.Xo,null),f.createElement("span",{className:"claims-letter"},x&&(null===(e=x[0])||void 0===e?void 0:e.dialectURI.charAt(0).toUpperCase())));default:return f.createElement(g.Z,{floated:"left",verticalAlign:"middle",rounded:!0,centered:!0,size:"tiny"},f.createElement(s.Xo,null),f.createElement("span",{className:"claims-letter"},"C"))}}(),backButton:{onClick:function(){l.m.push(r.$.getPaths().get("CLAIM_DIALECTS"))},text:D("claims:local.pageLayout.local.back")}},(null==x?void 0:x.length)>1?f.createElement(s.M$,{panes:function(){if(S===v.Q.SCIM){var e=[];if(v.Q.SCIM_TABS.forEach((function(t){if(!c.k9.hideCore1Schema||c.k9.scim.core1Schema!==t.uri){var n=null==x?void 0:x.find((function(e){return e.dialectURI===t.uri}));n&&e.push({menuItem:t.name,render:function(){return f.createElement(s.M$.Pane,{controlledSegmentation:!0,attached:!1},f.createElement(h.default,{id:n.id,attributeUri:t.uri,attributeType:S,mappedLocalClaims:Z,updateMappedClaims:j,isAttributeButtonEnabled:t.isAttributeButtonEnabled,attributeButtonText:D(t.attributeButtonText)}))}})}})),c.rk.showCustomDialectInSCIM){var t=null==x?void 0:x.find((function(e){return e.dialectURI===R}));t&&e.push({menuItem:"Custom Schema",render:function(){return f.createElement(s.M$.Pane,{controlledSegmentation:!0,attached:!1},f.createElement(h.default,{id:t.id,attributeType:S,attributeUri:t.dialectURI,mappedLocalClaims:Z,updateMappedClaims:j,isAttributeButtonEnabled:!0,attributeButtonText:D("claims:external.pageLayout.edit.attributePrimaryAction")}))}})}return e}if(S===v.Q.EIDAS){var n=[];return v.Q.EIDAS_TABS.forEach((function(e){var t=null==x?void 0:x.find((function(t){return t.dialectURI===e.uri}));t&&n.push({menuItem:e.name,render:function(){return f.createElement(s.M$.Pane,{controlledSegmentation:!0,attached:!1},f.createElement(h.default,{id:t.id,attributeUri:e.uri,attributeType:S,mappedLocalClaims:Z,updateMappedClaims:j,isAttributeButtonEnabled:e.isAttributeButtonEnabled,attributeButtonText:e.attributeButtonText}))}})})),n}return null==x?void 0:x.map((function(e){return{menuItem:e.dialectURI,render:function(){return f.createElement(s.M$.Pane,{controlledSegmentation:!0,attached:!1},f.createElement(h.default,{id:e.id,attributeType:S,attributeUri:e.dialectURI,mappedLocalClaims:Z,updateMappedClaims:j,isAttributeButtonEnabled:!0,attributeButtonText:D("claims:external.pageLayout.edit.attributePrimaryAction")}))}}}))}(),"data-testid":"".concat(d,"-tabs")}):f.createElement(h.default,{id:x&&(null===(t=x[0])||void 0===t?void 0:t.id),attributeType:S,attributeUri:x&&(null===(n=x[0])||void 0===n?void 0:n.dialectURI),mappedLocalClaims:Z,updateMappedClaims:j,isAttributeButtonEnabled:!0,attributeButtonText:D("claims:external.pageLayout.edit.attributePrimaryAction")}))};C.defaultProps={"data-testid":"edit-attribute-mappings"};const T=C},14755:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var i=n(55007),a=n(6894),r=n(60486),l=n(40838),c=n(79408),o=n(51021),u=n(6833),s=n(82406),d=n(43516),m=n(44194),f=n(10479),p=n(47245),E=n(89141),g=n(12638),h=n(41193),v=n(62508),b=n(53103),A=n(12252),I=n(99116);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r,l,c=[],o=!0,u=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(i=r.call(n)).done)&&(c.push(i.value),c.length!==t);o=!0);}catch(e){u=!0,a=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var C=function(e){var t,n=e.attributeType,S=e.attributeUri,C=e.mappedLocalClaims,T=e.isAttributeButtonEnabled,M=e.attributeButtonText,R=e.updateMappedClaims,D=e["data-testid"],U=e.id,Q=y((0,m.useState)(null),2),_=Q[0],L=Q[1],B=y((0,m.useState)(void 0),2),x=B[0],O=B[1],w=y((0,m.useState)(!0),2),Z=w[0],k=w[1],P=y((0,m.useState)(!1),2),H=P[0],j=P[1],N=(0,p.I0)(),X=(0,f.$)().t,$=(0,p.v9)((function(e){return e.config.ui.features})),V=function(e){(0,a.vR)(null!=e?e:U).then((function(e){L(e)})).catch((function(e){N((0,s.V_)({description:(null==e?void 0:e.description)||X("claims:dialects.notifications.fetchADialect.genericError.description"),level:u.QU.ERROR,message:(null==e?void 0:e.message)||X("claims:dialects.notifications.fetchADialect.genericError.message")}))}))};(0,m.useEffect)((function(){U&&V()}),[U]);var z=function(e,t,i,r){U&&k(!0),U&&O(void 0),U&&(0,a.gR)(U,{filter:r,limit:e,offset:t,sort:i}).then((function(e){var t=o.rk.attributeMappings.getExternalAttributes(n,e);O((0,c.f)(t,"claimURI",!0))})).catch((function(e){var t,i;N((0,s.V_)({description:(null==e||null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.description)||X("claims:dialects.notifications.fetchExternalClaims.genericError.description",{type:(0,I.i)(n)}),level:u.QU.ERROR,message:(null==e||null===(i=e.response)||void 0===i||null===(i=i.data)||void 0===i?void 0:i.message)||X("claims:dialects.notifications.fetchExternalClaims.genericError.message")}))})).finally((function(){k(!1)}))};(0,m.useEffect)((function(){z()}),[U]);var F=function(e){(0,a.Nx)(e).then((function(){l.m.push(r.$.getPaths().get("CLAIM_DIALECTS")),N((0,s.V_)({description:X("claims:dialects.notifications.deleteDialect.success.description",{type:(0,I.i)(n,!0)}),level:u.QU.SUCCESS,message:X("claims:dialects.notifications.deleteDialect.success.message")}))})).catch((function(e){N((0,s.V_)({description:(null==e?void 0:e.description)||X("claims:dialects.notifications.deleteDialect.genericError.description",{type:(0,I.i)(n,!0)}),level:u.QU.ERROR,message:(null==e?void 0:e.message)||X("claims:dialects.notifications.deleteDialect.genericError.message")}))}))};return m.createElement(m.Fragment,null,o.rk.attributeMappings.editAttributeMappingDetails&&m.createElement(m.Fragment,null,m.createElement(E.Z,null,m.createElement(E.Z.Row,{columns:1},m.createElement(E.Z.Column,{width:16},m.createElement(g.Z,{as:"h4"},X("claims:dialects.pageLayout.edit.updateDialectURI",{type:(0,I.i)(n,!0)})),m.createElement(d.pJ,null,Z?m.createElement(h.Z,null,m.createElement(h.Z.Line,{length:"short"}),m.createElement(h.Z.Line,{length:"medium"})):m.createElement(b.T8,{dialect:_,"data-testid":"".concat(D,"-edit-dialect-details"),attributeType:n,onUpdate:function(e){V(e)}}))))),m.createElement(v.Z,{hidden:!0}),m.createElement(E.Z,{columns:1},m.createElement(E.Z.Column,{width:16},m.createElement(g.Z,{as:"h4"},X("claims:dialects.pageLayout.edit.updateExternalAttributes",{type:(0,I.i)(n,!0)})))),m.createElement(v.Z,{hidden:!0}),m.createElement(v.Z,{hidden:!0})),m.createElement(b._v,{dialectID:U,isLoading:Z,claims:x,update:z,"data-testid":"".concat(D,"-edit-external-claims"),attributeType:n,attributeUri:S,mappedLocalClaims:C,updateMappedClaims:R,isAttributeButtonEnabled:T,attributeButtonText:M}),m.createElement(v.Z,{hidden:!0}),o.rk.attributeMappings.showDangerZone&&!A.Q.SYSTEM_DIALECTS.includes(null==_?void 0:_.id)&&m.createElement(E.Z,null,m.createElement(E.Z.Row,{columns:1},m.createElement(E.Z.Column,{width:16},m.createElement(i.di,{when:null==$||null===(t=$.oidcScopes)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.delete},m.createElement(d.v9,{sectionHeader:X("common:dangerZone"),"data-testid":"".concat(D,"-danger-zone-group")},m.createElement(d.cN,{actionTitle:X("claims:dialects.dangerZone.actionTitle",{type:(0,I.i)(n,!0,!0)}),header:X("claims:dialects.dangerZone.header",{type:(0,I.i)(n,!0)}),subheader:X("claims:dialects.dangerZone.subheader",{type:(0,I.i)(n)}),onActionClick:function(){return j(!0)},"data-testid":"".concat(D,"-dialect-delete-danger-zone")})))))),o.rk.attributeMappings.showDangerZone&&H&&m.createElement(d.cV,{onClose:function(){return j(!1)},type:"negative",open:H,assertion:_.dialectURI,assertionHint:m.createElement("p",null,"Please type ",m.createElement("strong",null,_.dialectURI)," to confirm."),assertionType:"input",primaryAction:X("claims:dialects.confirmations.action"),secondaryAction:X("common:cancel"),onSecondaryActionClick:function(){return j(!1)},onPrimaryActionClick:function(){return F(_.id)},"data-testid":"".concat(D,"-delete-confirmation-modal"),closeOnDimmerClick:!1},m.createElement(d.cV.Header,{"data-testid":"".concat(D,"-delete-confirmation-modal-header")},X("claims:dialects.confirmations.header")),m.createElement(d.cV.Message,{attached:!0,negative:!0,"data-testid":"".concat(D,"-delete-confirmation-modal-message")},X("claims:dialects.confirmations.message")),m.createElement(d.cV.Content,{"data-testid":"".concat(D,"-delete-confirmation-modal-content")},X("claims:dialects.confirmations.content",{type:(0,I.i)(n)}))))};C.defaultProps={attributeType:A.Q.OTHERS,"data-testid":"external-dialect-edit"};const T=C}}]);