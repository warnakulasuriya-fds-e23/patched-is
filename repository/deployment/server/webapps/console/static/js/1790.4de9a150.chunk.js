"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[1790],{33519:(e,t,n)=>{n.d(t,{u:()=>m});var l=n(37612),o=n(90695),i=n(63068),r=n(93139),a=n(26945),c=n(11192),s=n(43516),u=n(44194),d=n(10479),m=function(e){var t,n=e.isOpen,m=e.onClose,p=e.selectedRole,f=e["data-componentid"],v=(0,d.$)().t;return u.createElement(s.cV,{onClose:function(){return m()},type:"negative",open:n,secondaryAction:v("common:close"),onSecondaryActionClick:function(){return m()},"data-testid":f,closeOnDimmerClick:!1},u.createElement(s.cV.Header,{"data-testid":"".concat(f,"-header")},v("roles:list.confirmations.deleteItemError.header")),u.createElement(s.cV.Message,{attached:!0,negative:!0,"data-testid":"".concat(f,"-message")},v("roles:list.confirmations.deleteItemError.message")),u.createElement(s.cV.Content,{"data-testid":"".concat(f,"-content")},u.createElement("span",null,v("roles:list.confirmations.deleteItemError.content")),u.createElement(o.Z,{hidden:!0}),u.createElement(i.Z,null,u.createElement(r.Z,null,u.createElement(a.Z,null,u.createElement(l.sB,null)),u.createElement(c.Z,{primary:null==p||null===(t=p.audience)||void 0===t?void 0:t.display})))))};m.defaultProps={"data-componentid":"role-delete-error-confirmation-modal"}},11790:(e,t,n)=>{n.r(t),n.d(t,{default:()=>U});var l=n(55007),o=n(6567),i=n(25134),r=n(60486),a=n(54715),c=n(90302),s=n(40838),u=n(21257),d=n(6833),m=n(82406),p=n(43516),f=n(44194),v=n(10479),y=n(47245),h=n(26154),E=n(47625),g=n(46501),R=n(79282),A=n(1989),I=n(36940),b=n(86105),C=n(12638),L=n(37077),S=n(33519),O=n(7231);function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var l,o,i,r,a=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(l=i.call(n)).done)&&(a.push(l.value),a.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return T(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?T(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=Array(t);n<t;n++)l[n]=e[n];return l}var _=function(e){var t,n=e.handleRoleDelete,o=e.onEmptyListPlaceholderActionClick,i=e.onSearchQueryClear,a=e.roleList,c=e.searchQuery,u=e["data-componentid"],d=(0,v.$)().t,m=(0,y.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),E=(0,y.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.userRoles})),g=(0,y.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.administratorRoleDisplayName})),R=(0,y.v9)((function(e){return e.config.ui.features})),T=(0,y.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.isSystemRolesEditAllowed})),_=(0,f.useMemo)((function(){var e;return!(0,b.cr)(E,O.nL.FEATURE_DICTIONARY.get("ROLE_UPDATE"))||!(0,b.Xr)(E,null==E||null===(e=E.scopes)||void 0===e?void 0:e.update,m)}),[E,m]),k=P((0,f.useState)(!1),2),N=k[0],w=k[1],D=P((0,f.useState)(),2),U=D[0],Z=D[1],M=P((0,f.useState)(!1),2),x=M[0],V=M[1],Q=function(e){s.m.push(r.$.getPaths().get("ROLE_EDIT").replace(":id",e))};return f.createElement(f.Fragment,null,f.createElement(p.wQ,{loadingStateOptions:{imageType:"square"},actions:[{hidden:function(e){var t;return null==e||null===(t=e.meta)||void 0===t?void 0:t.systemRole},icon:function(){return _?"eye":"pencil alternate"},onClick:function(e,t){return!_&&Q(null==t?void 0:t.id)},popupText:function(){return d(_?"common:view":"common:edit")},renderer:"semantic-icon"},{hidden:function(e){var t,n,l,o=null==e||null===(t=e.properties)||void 0===t?void 0:t.some((function(e){return(null==e?void 0:e.name)===O.nL.IS_SHARED_ROLE&&"true"===(null==e?void 0:e.value)}));return(null==e||null===(n=e.meta)||void 0===n?void 0:n.systemRole)||(null==e?void 0:e.displayName)===I.nL.ADMIN_ROLE||(null==e?void 0:e.displayName)===I.nL.ADMIN_GROUP||(null==e?void 0:e.displayName)===g||!(0,b.cr)(E,O.nL.FEATURE_DICTIONARY.get("ROLE_DELETE"))||!(0,b.Xr)(E,null==E||null===(l=E.scopes)||void 0===l?void 0:l.delete,m)||o},icon:function(){return"trash alternate"},onClick:function(e,t){!function(e){var t;Z(e),(null==e||null===(t=e.audience)||void 0===t||null===(t=t.type)||void 0===t?void 0:t.toUpperCase())===O.cv.APPLICATION?V(!0):w(!0)}(t)},popupText:function(){return d("roles:list.popups.delete",{type:"Role"})},renderer:"semantic-icon"}],columns:[{allowToggleVisibility:!1,dataIndex:"name",id:"name",key:"name",render:function(e){var t,n=null==e||null===(t=e.properties)||void 0===t?void 0:t.some((function(e){return(null==e?void 0:e.name)===O.nL.IS_SHARED_ROLE&&"true"===(null==e?void 0:e.value)}));return f.createElement(C.Z,{image:!0,as:"h6",className:"header-with-icon","data-componentid":"".concat(u,"-item-heading")},f.createElement(p.JT,{image:f.createElement(p.Xo,{name:null==e?void 0:e.displayName[0],size:"mini","data-componentid":"".concat(u,"-item-image-inner")}),size:"mini",spaced:"right","data-componentid":"".concat(u,"-item-image")}),f.createElement(C.Z.Content,null,null==e?void 0:e.displayName,n&&f.createElement(L.Z,{size:"mini"},d("roles:list.labels.shared"))))},title:d("roles:list.columns.name")},{allowToggleVisibility:!1,dataIndex:"audience",id:"audience",key:"audience",render:function(e){return(null==e?void 0:e.audience)&&f.createElement(L.Z,{size:"mini"},e.audience.type,e.audience.type.toUpperCase()===O.cv.APPLICATION?" | ".concat(e.audience.display," "):"")},title:f.createElement("div",{className:"pl-3"},d("roles:list.columns.audience"))},{allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:null}],data:null==a?void 0:a.Resources,onRowClick:function(e,t){var n;!T&&null!=t&&null!==(n=t.meta)&&void 0!==n&&n.systemRole||Q(null==t?void 0:t.id)},placeholders:c&&0===(null==a?void 0:a.totalResults)?f.createElement(p.$J,{"data-componentid":"".concat(u,"-search-empty-placeholder"),action:f.createElement(p.Qj,{"data-componentid":"".concat(u,"-search-empty-placeholder-clear-button"),onClick:i},d("roles:list.emptyPlaceholders.search.action")),image:(0,A.jF)().emptySearch,imageSize:"tiny",title:d("roles:list.emptyPlaceholders.search.title"),subtitle:[d("roles:list.emptyPlaceholders.search.subtitles.0",{searchQuery:c}),d("roles:list.emptyPlaceholders.search.subtitles.1")]}):0===(null==a?void 0:a.totalResults)?f.createElement(p.$J,{"data-componentid":"".concat(u,"-empty-list-empty-placeholder"),action:f.createElement(l.di,{when:null==R||null===(t=R.userRoles)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.create},f.createElement(p.KM,{"data-componentid":"".concat(u,"-empty-list-empty-placeholder-add-button"),onClick:o},f.createElement(h.Z,{name:"add"}),d("roles:list.emptyPlaceholders.emptyRoleList.action",{type:"Role"}))),image:(0,A.jF)().newList,imageSize:"tiny",title:d("roles:list.emptyPlaceholders.emptyRoleList.title",{type:"role"}),subtitle:[d("roles:list.emptyPlaceholders.emptyRoleList.subtitles.0",{type:"roles"}),d("roles:list.emptyPlaceholders.emptyRoleList.subtitles.1",{type:"role"}),d("roles:list.emptyPlaceholders.emptyRoleList.subtitles.2",{type:"role"})]}):null,"data-componentid":u}),N&&f.createElement(p.cV,{"data-componentid":"".concat(u,"-delete-item-confirmation-modal"),onClose:function(){return w(!1)},type:"negative",open:N,assertionHint:d("roles:list.confirmations.deleteItem.assertionHint"),assertionType:"checkbox",primaryAction:d("common:confirm"),secondaryAction:d("common:cancel"),onSecondaryActionClick:function(){return w(!1)},onPrimaryActionClick:function(){n(U),w(!1)},closeOnDimmerClick:!1},f.createElement(p.cV.Header,null,d("roles:list.confirmations.deleteItem.header")),f.createElement(p.cV.Message,{attached:!0,negative:!0},d("roles:list.confirmations.deleteItem.message",{type:"role"})),f.createElement(p.cV.Content,null,d("roles:list.confirmations.deleteItem.content",{type:"role"}))),x&&f.createElement(S.u,{isOpen:x,onClose:function(){V(!1),Z(void 0)},selectedRole:U,"data-componentid":"".concat(u,"-role-delete-error-confirmation-modal")}))};_.defaultProps={"data-componentid":"role-mgt-roles-list"};var k=n(59870);function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var l,o,i,r,a=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(l=i.call(n)).done)&&(a.push(l.value),a.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=Array(t);n<t;n++)l[n]=e[n];return l}var D=function(e){var t,n=e["data-componentid"],A=(0,y.I0)(),I=(0,v.$)().t,b=(0,p.fQ)().getLink,C=(0,u.z)().organizationType,L=(0,y.v9)((function(e){return e.config.ui.features})),S=N((0,f.useState)(c.r.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),2),O=S[0],P=S[1],T=N((0,f.useState)(0),2),w=T[0],D=T[1],U=N((0,f.useState)(void 0),2),Z=U[0],M=U[1],x=N((0,f.useState)(!1),2),V=x[0],Q=x[1],F=C===a.$.SUBORGANIZATION,j=(0,o.Ok)(null,null,null,"name eq Console").data,z=(0,f.useMemo)((function(){var e;return null==j||null===(e=j.applications[0])||void 0===e?void 0:e.id}),[j]),$=(0,R.Z)(O,w,function(e){return"audience.value ne ".concat(z).concat(e?" and ".concat(e):"")}(Z),"users,groups,permissions,associatedApplications"),H=$.data,G=$.isLoading,X=$.error,B=$.mutate,J=[{key:void 0,text:I("roles:list.filterOptions.all"),value:void 0},{key:k.nL.ROLE_AUDIENCE_APPLICATION_FILTER,text:I("roles:list.filterOptions.applicationRoles"),value:k.nL.ROLE_AUDIENCE_APPLICATION_FILTER},{key:k.nL.ROLE_AUDIENCE_ORGANIZATION_FILTER,text:I("roles:list.filterOptions.organizationRoles"),value:k.nL.ROLE_AUDIENCE_ORGANIZATION_FILTER}];(0,f.useEffect)((function(){X&&q({description:I("roles:notifications.fetchRoles.genericError.description"),level:d.QU.ERROR,message:I("roles:notifications.fetchRoles.genericError.message")})}),[X]);var q=function(e){A((0,m.V_)(e))},K=function(){s.m.push(r.$.getPaths().get("ROLE_CREATE"))};return f.createElement(p.Xg,{action:!G&&(null==H?void 0:H.totalResults)>0?f.createElement(l.di,{when:null==L||null===(t=L.userRoles)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.create},f.createElement(p.KM,{"data-componentid":"".concat(n,"-add-button"),onClick:function(){return K()}},f.createElement(h.Z,{"data-componentid":"".concat(n,"-add-button-icon"),name:"add"}),I("roles:list.buttons.addButton",{type:"Role"}))):null,title:I("pages:roles.title"),pageTitle:I("pages:roles.title"),description:f.createElement(f.Fragment,null,I("pages:roles.subTitle"),f.createElement(p.eb,{link:b("develop.applications.roles.learnMore")},I("common:learnMore")))},f.createElement(p.PS,{advancedSearch:f.createElement(i.n,{"data-componentid":"".concat(n,"-list-advanced-search"),onFilter:function(e){"displayName sw "!==e?M(e):B()},filterAttributeOptions:[{key:0,text:I("roles:list.filterAttirbutes.name"),value:"displayName"},{key:1,text:I("roles:list.filterAttirbutes.audience"),value:"audience.type"}],filterAttributePlaceholder:I("roles:advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:I("roles:advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:I("roles:advancedSearch.form.inputs.filterValue.placeholder"),placeholder:I("roles:advancedSearch.placeholder"),defaultSearchAttribute:"displayName",defaultSearchOperator:"co",triggerClearQuery:V}),currentListSize:null==H?void 0:H.itemsPerPage,listItemLimit:O,onItemsPerPageDropdownChange:function(e,t){P(t.value)},onPageChange:function(e,t){var n=(t.activePage-1)*O+1;D(n)},showTopActionPanel:(null==H?void 0:H.totalResults)>0||0!==(null==Z?void 0:Z.length),rightActionPanel:f.createElement(E.Z,{"data-componentid":"".concat(n,"-list-filters-dropdown"),selection:!0,options:J,placeholder:I("roles:list.buttons.filterDropdown"),onChange:function(e,t){M(t.value)}}),showPagination:!0,totalPages:Math.ceil((null==H?void 0:H.totalResults)/O),totalListSize:null==H?void 0:H.totalResults,isLoading:G},f.createElement(_,{handleRoleDelete:function(e){(0,g.iy)(e.id).then((function(){q({description:I("roles:notifications.deleteRole.success.description"),level:d.QU.SUCCESS,message:I("roles:notifications.deleteRole.success.message")}),B()})).catch((function(e){e.response&&e.response.data&&e.response.data.detail?q({description:e.response.data.detail,level:d.QU.ERROR,message:I("roles:notifications.deleteRole.error.message")}):q({description:I("roles:notifications.deleteRole.genericError.description"),level:d.QU.ERROR,message:I("roles:notifications.deleteRole.genericError.message")})}))},onEmptyListPlaceholderActionClick:function(){return K()},onSearchQueryClear:function(){Q(!V),M(null)},roleList:H,searchQuery:Z,isSubOrg:F})))};D.defaultProps={"data-componentid":"roles-mgt"};const U=D}}]);