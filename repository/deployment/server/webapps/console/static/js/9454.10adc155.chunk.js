"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[9454],{79454:(e,t,n)=>{n.r(t),n.d(t,{Saml2ConfigurationPage:()=>P,default:()=>D});var a,i=n(60486),o=n(40838),r=n(43939),l=n(86105),s=n(6833),c=n(82406),u=n(16590),d=n(30382),m=n(43516),f=n(34194),g=n(44194),E=n(10479),p=n(47245),v=n(89141),C=n(41193),_=n(62508),R=n(41206),h=n(11526),y=n(65388),S=n(96124),b=n(60507);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function L(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,I(a.key),a)}}function w(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function A(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){var t=function(e,t){if("object"!=O(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=O(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==O(t)?t:t+""}var M=w((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));a=M,A(M,"SAML2_CONFIG_FETCH_ERROR_CODE","SMC-00001"),A(M,"SAML2_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE","SMC-00002"),A(M,"SAML2_CONFIG_UPDATE_ERROR_CODE","SMC-00003"),A(M,"SAML2_CONFIG_FIELD_MIN_LENGTH",0),A(M,"ErrorMessages",{SAML2_CONFIG_FETCH_ERROR_CODE:new b.O(a.SAML2_CONFIG_FETCH_ERROR_CODE,"An error occurred while fetching the saml2 configurations.","Error while fetching the saml2 configurations",null),SAML2_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE:new b.O(a.SAML2_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE,"Received an invalid status code while fetching the saml2 configurations.","Invalid Status Code while fetching the saml2 configurations",null),SAML2_CONFIG_UPDATE_ERROR_CODE:new b.O(a.SAML2_CONFIG_UPDATE_ERROR_CODE,"An error occurred while updating the saml2 configurations.","Error while updating the saml2 configurations",null)});var N=h.AsgardeoSPAClient.getInstance().httpRequest.bind(h.AsgardeoSPAClient.getInstance());function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,o,r,l=[],s=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(a=o.call(n)).done)&&(l.push(a.value),l.length!==t);s=!0);}catch(e){c=!0,i=e}finally{try{if(!s&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(c)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return U(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var P=function(e){var t,n,a,h,b=e["data-componentid"],O=(0,g.useRef)(null),L=(0,g.useRef)(null),w=(0,g.useRef)(),A=(0,p.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.governanceConnectors})).deprecatedFeaturesToShow.find((function(e){return"saml2"===(null==e?void 0:e.name)})),I=(0,p.v9)((function(e){return e.config.ui.features})),U=(0,p.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),P=(0,g.useMemo)((function(){var e;return!(0,l.Xr)(null==I?void 0:I.governanceConnectors,null==I||null===(e=I.governanceConnectors)||void 0===e||null===(e=e.scopes)||void 0===e?void 0:e.update,U)}),[I,U]),D=(0,p.I0)(),F=(0,E.$)().t,V=T((0,g.useState)(!1),2),Z=V[0],G=V[1],k=T((0,g.useState)(void 0),2),j=k[0],H=k[1],x=T((0,g.useState)(""),2),q=x[0],Q=x[1],$=T((0,g.useState)(!1),2),z=$[0],B=$[1],X=(t={headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.GET,url:y.D.getServiceResourceEndpoints().saml2Configurations},n=(0,S.Z)(t),a=n.data,h=n.error,{data:a,error:h,isLoading:!h&&!a,isValidating:n.isValidating,mutate:n.mutate}),J=X.data,K=X.isLoading,W=X.mutate,Y=X.error;(0,g.useEffect)((function(){var e,t;J instanceof r.u||Y?ee():J&&(H({enableMetadataSigning:null!==(e=J.enableMetadataSigning)&&void 0!==e&&e,metadataValidityPeriod:null!==(t=J.metadataValidityPeriod)&&void 0!==t?t:0}),Q(J.destinationURLs.length>0?J.destinationURLs.toString():""))}),[J]);var ee=function(){D((0,c.V_)({description:F("saml2Config:notifications.getConfiguration.error.description"),level:s.QU.ERROR,message:F("saml2Config:notifications.getConfiguration.error.message")}))};return g.createElement(m.Xg,{title:F("saml2Config:title"),pageTitle:F("saml2Config:title"),description:F("saml2Config:description"),backButton:{onClick:function(){o.m.push(i.$.getPaths().get("LOGIN_AND_REGISTRATION"))},text:F("governanceConnectors:goBackLoginAndRegistration")},bottomMargin:!1,contentTopMargin:!1,"data-componentid":"".concat(b,"-form-layout"),pageHeaderMaxWidth:!0},g.createElement(R.R,{innerRef:O},g.createElement(v.Z,{className:"mt-2"},g.createElement(v.Z.Row,{columns:1},g.createElement(v.Z.Column,{width:16},g.createElement(m.pJ,{className:"form-wrapper",padded:"very"},K?g.createElement(v.Z.Row,{columns:1},g.createElement("div",null,g.createElement("div",{className:"ui card fluid settings-card","data-testid":"".concat(b,"-loading-card")},g.createElement("div",{className:"content no-padding"},g.createElement("div",{className:"header-section"},g.createElement(C.Z,null,g.createElement(C.Z.Header,null,g.createElement(C.Z.Line,{length:"medium"}),g.createElement(C.Z.Line,{length:"full"}))),g.createElement(_.Z,{hidden:!0}))),g.createElement("div",{className:"content extra extra-content"},g.createElement("div",{className:"action-button"},g.createElement(C.Z,null,g.createElement(C.Z.Line,{length:"very short"}))))),g.createElement(_.Z,{hidden:!0}))):g.createElement(g.Fragment,null,g.createElement(d.l0,{id:"saml2-config-form",uncontrolledForm:!0,onSubmit:function(e){G(!0),function(e){var t={data:e,headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.PATCH,url:y.D.getServiceResourceEndpoints().saml2Configurations};return N(t).then((function(e){if(200!==e.status&&201!==e.status)throw new r.u(M.ErrorMessages.SAML2_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE.getErrorMessage(),null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var t,n=M.ErrorMessages.SAML2_CONFIG_UPDATE_ERROR_CODE.getErrorMessage();throw new r.u(n,e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))}({destinationURLs:null==q?void 0:q.split(","),enableMetadataSigning:e.enableMetadataSigning,metadataValidityPeriod:e.metadataValidityPeriod}).then((function(){D((0,c.V_)({description:F("saml2Config:notifications.updateConfiguration.success.description"),level:s.QU.SUCCESS,message:F("saml2Config:notifications.updateConfiguration.success.message")}))})).catch((function(){D((0,c.V_)({description:F("saml2Config:notifications.updateConfiguration.error.description"),level:s.QU.ERROR,message:F("saml2Config:notifications.updateConfiguration.error.message")}))})).finally((function(){G(!1),W()}))},initialValues:j,enableReinitialize:!0,ref:L,validate:function(e){var t={destinationURLs:void 0,metadataValidityPeriod:void 0};return null!=e&&e.metadataValidityPeriod&&(!f.I.isInteger(e.metadataValidityPeriod)||e.metadataValidityPeriod<0)&&(t.metadataValidityPeriod=F("saml2Config:form.validation.metadataValidityPeriod")),null!=e&&e.destinationURLs&&e.destinationURLs.length>0&&(t.destinationURLs=F("saml2Config:form.validation.destinationURLs")),t},autoComplete:"new-password"},g.createElement(v.Z,null,g.createElement(v.Z.Row,{columns:1,key:3},g.createElement(v.Z.Column,{width:10},g.createElement(d.gN.Checkbox,{ariaLabel:F("saml2Config:form.enableMetadataSigning.label"),name:"enableMetadataSigning",label:F("saml2Config:form.enableMetadataSigning.label"),readOnly:P,"data-componentid":"".concat(b,"-\n                                                                    enable-metadata-signing"),toggle:!0}))),g.createElement(v.Z.Row,{columns:1,key:1},g.createElement(v.Z.Column,{width:10},g.createElement(d.gN.Input,{min:M.SAML2_CONFIG_FIELD_MIN_LENGTH,ariaLabel:F("saml2Config:form.metadataValidityPeriod.label"),inputType:"number",name:"metadataValidityPeriod",label:F("saml2Config:form.metadataValidityPeriod.label"),hint:F("saml2Config:form.metadataValidityPeriod.hint"),value:null==j?void 0:j.metadataValidityPeriod,readOnly:P,minLength:M.SAML2_CONFIG_FIELD_MIN_LENGTH,maxLength:null,"data-componentid":"".concat(b,"-metadata-validity-period"),autoComplete:"new-password"}))),(null==A?void 0:A.deprecatedProperties.includes("destinationURLs.pattern"))&&g.createElement(v.Z.Row,{columns:1,key:2},g.createElement(v.Z.Column,{width:10,key:"destinationUrl"},g.createElement("div",{ref:w}),g.createElement(m.wE,{urlState:q,setURLState:function(e){var t,n=null==e||null===(t=e.split(","))||void 0===t?void 0:t.toString();Q(n)},labelName:F("saml2Config:form.destinationUrl.label"),hint:F("saml2Config:form.destinationUrl.hint"),required:!0,showError:z,setShowError:B,validationErrorMsg:F("saml2Config:form.validation.destinationURLs"),validation:function(e){return!!u.URLUtils.isURLValid(e,!0)||(B(!0),!1)},readOnly:P,addURLTooltip:F("common:addURL"),duplicateURLErrorMessage:F("common:duplicateURLError"),"data-componentid":"".concat(b,"\n                                                                            -destination-url-input"),showPredictions:!1}))))),!P&&g.createElement(g.Fragment,null,g.createElement(_.Z,{hidden:!0}),g.createElement(v.Z.Row,{columns:1,className:"mt-6"},g.createElement(v.Z.Column,{width:10},g.createElement(m.KM,{size:"small",loading:Z,onClick:function(){var e;null==L||null===(e=L.current)||void 0===e||e.triggerSubmit()},ariaLabel:"saml2 configuration form update button","data-componentid":"".concat(b,"-update-button")},F("common:update"))))))))))))};P.defaultProps={"data-componentid":"saml2-configuration-settings-page"};const D=P}}]);