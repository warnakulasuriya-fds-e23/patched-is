"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[8420],{86692:(e,n,r)=>{r.d(n,{Z:()=>o});var t=r(96124),i=r(6833);const o=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0,o={headers:{Accept:"application/json","Content-Type":"application/json"},method:i.f2.GET,params:{attributes:r,filter:n},url:("".concat(window.AppUtils.getServerOriginWithTenant(!1),"/api/server/v1/meta/api-resource-collections/:id"),"".concat(window.AppUtils.getServerOriginWithTenant(!1),"/api/server/v1/meta/api-resource-collections"))},a=(0,t.Z)(e?o:null,{shouldRetryOnError:!1}),l=a.data,s=a.error;return{data:l,error:s,isLoading:!s&&!l,isValidating:a.isValidating,mutate:a.mutate}}},98420:(e,n,r)=>{r.d(n,{Z:()=>K});var t=r(87449),i=r(17652),o=r(38480),a=r(27044),l=r(53080),s=r(264),c=r(3001),u=r(77366),d=r(23210),m=r(91626),p=r(17498),f=r(40018),v=r(89497),b=r(37612),g=r(90302),y=r(21257),E=r(47513),h=r(64704),O=r(50699),Z=r(44194),w=r(10479),S=r(47245),N=r(86692),R=r(23852),A=function(e){return e.TENANT="tenant",e.ORGANIZATION="organization",e}({}),C=r(83476),_=r(51835),z=r.n(_),T=r(27975),x=r.n(T),I=r(55900),k=r.n(I),L=r(21555),P=r.n(L),j=r(3621),M=r.n(j),U=r(5062),V=r.n(U),G=r(94575),D={};D.styleTagTransform=V(),D.setAttributes=P(),D.insert=k().bind(null,"head"),D.domAPI=x(),D.insertStyleElement=M();z()(G.Z,D);G.Z&&G.Z.locals&&G.Z.locals;function W(e){return function(e){if(Array.isArray(e))return J(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||F(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,i,o,a,l=[],s=!0,c=!1;try{if(o=(r=r.call(e)).next,0===n){if(Object(r)!==r)return;s=!1}else for(;!(s=(t=o.call(r)).done)&&(l.push(t.value),l.length!==n);s=!0);}catch(e){c=!0,i=e}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return l}}(e,n)||F(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,n){if(e){if("string"==typeof e)return J(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?J(e,n):void 0}}function J(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=Array(n);r<n;r++)t[r]=e[r];return t}var $="tenant-permissions",B="organization-permissions",H=function(e){var n,r,_,z,T,x,I=e.isReadOnly,k=e.defaultExpandedIfPermissionsAreSelected,L=e.initialValues,P=e.onPermissionsChange,j=e["data-componentid"],M=(0,w.$)().t,U=(0,N.Z)(!0,"type eq tenant","apiResources").data,V=(0,N.Z)(!0,"type eq organization","apiResources").data,G=(0,S.v9)((function(e){return e.config.ui.features})),D=q((0,Z.useState)([]),2),F=D[0],J=D[1],H=q((0,Z.useState)(L||{organization:{},tenant:{}}),2),K=H[0],Q=H[1],X=(0,y.z)().isSubOrganization;(0,Z.useEffect)((function(){if(L&&(Q(L),k)){var e=[];(0,O.Z)(L.tenant)||e.push($),(0,O.Z)(L.organization)||e.push(B),J(e)}}),[L]);var Y=(0,Z.useMemo)((function(){var e;if(!U)return null;var n=(0,E.Z)(U),r=[];return r.push(R.S.ROLE_V1_API_RESOURCES_COLLECTION_NAME),n.apiResourceCollections=null==n||null===(e=n.apiResourceCollections)||void 0===e?void 0:e.filter((function(e){var n,t;return!r.includes(null==e?void 0:e.name)&&((null==G||null===(n=G[null==e?void 0:e.name])||void 0===n?void 0:n.enabled)||(null==G||null===(t=G[g.r.CONSOLE_FEATURE_MAP[null==e?void 0:e.name]])||void 0===t?void 0:t.enabled))})),n}),[U]),ee=(0,Z.useMemo)((function(){var e;if(!V)return null;var n=(0,E.Z)(V),r=[];return r.push(R.S.ORG_ROLE_V1_API_RESOURCES_COLLECTION_NAME),n.apiResourceCollections=null==n||null===(e=n.apiResourceCollections)||void 0===e?void 0:e.filter((function(e){return!r.includes(null==e?void 0:e.name)})),n}),[V]),ne=function(e){return function(n,r){J(r?[].concat(W(F),[e]):F.filter((function(n){return n!==e})))}},re=function(e,n){var r=(0,E.Z)(K);n===A.TENANT?e.target.checked?r.tenant=((null==Y?void 0:Y.apiResourceCollections)||[]).reduce((function(e,n){return e[n.id]={permissions:(0,C.Z)(n.apiResources.read),read:!0,write:!1},e}),{}):r.tenant={}:e.target.checked?r.organization=((null==ee?void 0:ee.apiResourceCollections)||[]).reduce((function(e,n){return e[n.id]={permissions:(0,C.Z)(n.apiResources.read),read:!0,write:!1},e}),{}):r.organization={},Q(r),te(r)},te=function(e){var n=new Set;Object.keys(e).forEach((function(r){var t=e[r];Object.keys(t).forEach((function(e){var r=t[e];r.permissions&&r.permissions.length>0&&r.permissions.forEach((function(e){n.add(JSON.stringify(e))}))}))}));var r=Array.from(n).map((function(e){return JSON.parse(e)}));P(r)},ie=function(e,n,r){var t=n.id,i=n.apiResources,o=(0,E.Z)(K);e.target.checked?o[r][t]={permissions:(0,C.Z)(i.read),read:!0,write:!1}:delete o[r][t],Q(o),te(o)},oe=function(e,n,r,t){var i=n.id,o=n.apiResources,a=(0,E.Z)(K);a[t][i]={permissions:(0,C.Z)(o[r]),read:"read"===r,write:"write"===r},Q(a),te(a)};return Z.createElement("div",{className:"create-console-role-wizard-permissions-form","data-componentid":j},!X()&&Z.createElement("div",{className:"accordion-container"},Z.createElement(u.Z,{elevation:0,expanded:F.includes($),onChange:ne($),className:"tenant-permissions-accordion"},Z.createElement(m.Z,{expandIcon:Z.createElement(b.v4,null),"aria-controls":"tenant-permissions-content",id:"tenant-permissions-header"},Z.createElement(p.Z,{readOnly:I,disabled:I,color:"primary",checked:Object.keys(K.tenant).length===(null==Y||null===(n=Y.apiResourceCollections)||void 0===n?void 0:n.length),onChange:function(e){re(e,A.TENANT)},inputProps:{"aria-label":"Select all tenant permissions"}}),Z.createElement(v.Z,{className:"permissions-accordion-label"},M("consoleSettings:roles.add.tenantPermissions.label")),Z.createElement(v.Z,{variant:"body2"},null==Y||null===(r=Y.apiResourceCollections)||void 0===r?void 0:r.length," Permissions")),Z.createElement(d.Z,null,Z.createElement(a.Z,{component:f.Z,elevation:0},Z.createElement(t.Z,{className:"permissions-table",size:"small","aria-label":"tenant permissions table"},Z.createElement(i.Z,null,null==Y||null===(_=Y.apiResourceCollections)||void 0===_?void 0:_.map((function(e){var n;return Z.createElement(l.Z,{key:e.id,className:"permissions-table-data-row"},Z.createElement(o.Z,{padding:"checkbox"},Z.createElement(p.Z,{readOnly:I,disabled:I,color:"primary",checked:Object.keys(K.tenant).includes(e.id),onChange:function(n){return ie(n,e,A.TENANT)},inputProps:{"aria-label":"Select ".concat(e.displayName," permission")}})),Z.createElement(o.Z,{component:"th",scope:"row"},e.displayName),Z.createElement(o.Z,{align:"right"},Z.createElement(c.Z,{disabled:I,value:Object.keys(K.tenant).includes(e.id)?null!==(n=(0,h.Z)(K.tenant,e.id))&&void 0!==n&&n.write?"write":"read":null,exclusive:!0,onChange:function(n,r){r&&oe(0,e,r,A.TENANT)},"aria-label":"text alignment",size:"small"},Z.createElement(s.Z,{value:"read","aria-label":"left aligned"},M("consoleSettings:roles.permissionLevels.view")),Z.createElement(s.Z,{value:"write","aria-label":"right aligned"},M("consoleSettings:roles.permissionLevels.edit")))))})))))))),Z.createElement("div",{className:"accordion-container"},Z.createElement(u.Z,{elevation:0,expanded:F.includes(B),onChange:ne(B),className:"organization-permissions-accordion"},Z.createElement(m.Z,{expandIcon:Z.createElement(b.v4,null),"aria-controls":"panel1bh-content",id:"panel1bh-header"},Z.createElement(p.Z,{readOnly:I,disabled:I,color:"primary",checked:Object.keys(K.organization).length===(null==ee||null===(z=ee.apiResourceCollections)||void 0===z?void 0:z.length),onChange:function(e){re(e,A.ORGANIZATION)},inputProps:{"aria-label":"Select all organization permissions"}}),Z.createElement(v.Z,{className:"permissions-accordion-label"},M("consoleSettings:roles.add.organizationPermissions.label")),Z.createElement(v.Z,{variant:"body2"},null==ee||null===(T=ee.apiResourceCollections)||void 0===T?void 0:T.length," Permissions")),Z.createElement(d.Z,null,Z.createElement(a.Z,{component:f.Z,elevation:0},Z.createElement(t.Z,{className:"permissions-table",size:"small","aria-label":"organization permissions table"},Z.createElement(i.Z,null,null==ee||null===(x=ee.apiResourceCollections)||void 0===x?void 0:x.map((function(e){var n;return Z.createElement(l.Z,{key:e.id,className:"permissions-table-data-row"},Z.createElement(o.Z,{padding:"checkbox"},Z.createElement(p.Z,{readOnly:I,disabled:I,color:"primary",checked:Object.keys(K.organization).includes(e.id),onChange:function(n){return ie(n,e,A.ORGANIZATION)},inputProps:{"aria-label":"Select ".concat(e.displayName," permission")}})),Z.createElement(o.Z,{component:"th",scope:"row"},e.displayName),Z.createElement(o.Z,{align:"right"},Z.createElement(c.Z,{disabled:I,value:Object.keys(K.organization).includes(e.id)?null!==(n=(0,h.Z)(K.organization,e.id))&&void 0!==n&&n.write?"write":"read":null,exclusive:!0,onChange:function(n,r){oe(0,e,r,A.ORGANIZATION)},"aria-label":"text alignment",size:"small"},Z.createElement(s.Z,{value:"read","aria-label":"left aligned"},M("consoleSettings:roles.permissionLevels.view")),Z.createElement(s.Z,{value:"write","aria-label":"right aligned"},M("consoleSettings:roles.permissionLevels.edit")))))})))))))))};H.defaultProps={"data-componentid":"create-console-role-wizard-basic-info-form"};const K=H},23852:(e,n,r)=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function i(e,n){for(var r=0;r<n.length;r++){var t=n[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,l(t.key),t)}}function o(e,n,r){return n&&i(e.prototype,n),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,n,r){return(n=l(n))in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function l(e){var n=function(e,n){if("object"!=t(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,n||"default");if("object"!=t(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==t(n)?n:n+""}r.d(n,{S:()=>s});var s=o((function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e)}));a(s,"ADD_NEW_ROLE_FORM_ID","add-new-console-role-wizard-form"),a(s,"ROLE_V1_API_RESOURCES_COLLECTION_NAME","rolesV1"),a(s,"ROLE_API_RESOURCES_COLLECTION_NAME","roles"),a(s,"ORG_ROLE_V1_API_RESOURCES_COLLECTION_NAME","org_rolesV1"),a(s,"ORG_ROLE_API_RESOURCES_COLLECTION_NAME","org_roles")},83476:(e,n,r)=>{r.d(n,{Z:()=>t});const t=function(e){return e.map((function(e){return e.scopes.map((function(e){return{value:e.name}}))})).reduce((function(e,n){return e.concat(n)}),[])}},94575:(e,n,r)=>{r.d(n,{Z:()=>l});var t=r(51139),i=r.n(t),o=r(32234),a=r.n(o)()(i());a.push([e.id,".create-console-role-wizard-permissions-form{margin-top:20px}.create-console-role-wizard-permissions-form .oxygen-accordion{border:1px solid var(--oxygen-palette-divider);margin:10px 0}.create-console-role-wizard-permissions-form .oxygen-accordion .permissions-accordion-label{width:40%;flex-shrink:0}.create-console-role-wizard-permissions-form .oxygen-accordion .permissions-table .permissions-table-data-row:last-child td,.create-console-role-wizard-permissions-form .oxygen-accordion .permissions-table .permissions-table-data-row:last-child th{border:none}.create-console-role-wizard-permissions-form .oxygen-accordion .oxygen-accordion-summary .MuiAccordionSummary-content{display:flex;flex-direction:row;flex-wrap:nowrap;align-content:center;align-items:center;justify-content:flex-start}.create-console-role-wizard-permissions-form .accordion-container .oxygen-accordion.Mui-expanded:first-of-type{margin-top:10px}",""]);const l=a}}]);